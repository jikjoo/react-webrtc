{"version":3,"sources":["helpers/simple-peer.js","helpers/media-access.js","components/Icons.js","components/video.js","components/goToRoomInput.js","App.js","registerServiceWorker.js","index.js"],"names":["VideoCall","peer","init","stream","initiator","_this","Peer","trickle","reconnectTimer","iceTransportPolicy","config","iceServers","urls","process","split","username","credential","connect","otherId","signal","_callee","regenerator_default","a","wrap","_context","prev","next","abrupt","navigator","mediaDevices","getDisplayMedia","stop","ShareScreenIcon","react_default","createElement","xmlns","width","height","viewBox","fill","d","MicOnIcon","MicOffIcon","CamOnIcon","CamOffIcon","Video","Object","classCallCheck","this","possibleConstructorReturn","getPrototypeOf","call","videoCall","enter","roomId","setState","connecting","state","localStream","on","data","room","desc","socket","emit","remoteVideo","srcObject","waiting","err","console","log","renderFull","full","remoteStreamUrl","streamUrl","micState","camState","io","component","props","match","params","getUserMedia","then","type","cb","_this2","Promise","resolve","reject","webkitGetUserMedia","mozGetUserMedia","video","min","ideal","max","audio","localVideo","getAudioTracks","length","forEach","track","enabled","getVideoTracks","_this3","_getDisplayStream","apply","arguments","getDisplayStream","oninactive","removeStream","addStream","_this4","className","autoPlay","id","muted","ref","concat","onClick","getDisplay","Icons_ShareScreenIcon","setAudioLocal","Icons_MicOnIcon","Icons_MicOffIcon","setVideoLocal","Icons_CamOnIcon","Icons_CamOffIcon","React","Component","goToRoom","history","push","goToRoomInput","_ref","_useState","useState","shortId","generate","_useState2","slicedToArray","setRoomId","value","placeholder","onChange","event","target","App","BrowserRouter","Fragment","Route","path","exact","isLocalhost","Boolean","window","location","hostname","registerValidSW","swUrl","serviceWorker","register","registration","onupdatefound","installingWorker","installing","onstatechange","controller","catch","error","ReactDOM","render","src_App_0","document","getElementById","URL","origin","addEventListener","fetch","response","status","headers","get","indexOf","ready","unregister","reload","checkValidServiceWorker","registerServiceWorker"],"mappings":"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","file":"static/js/main.c08fc37e.chunk.js","sourcesContent":["import Peer from 'simple-peer'\r\n\r\nexport default class VideoCall {\r\n    peer = null \r\n    init = (stream, initiator) => {\r\n        this.peer = new Peer({\r\n            initiator: initiator,\r\n            stream: stream,\r\n            trickle: false,\r\n            reconnectTimer: 1000,\r\n            iceTransportPolicy: 'relay',\r\n            config: {\r\n                iceServers: [\r\n                    { urls: process.env.REACT_APP_STUN_SERVERS.split(',') },\r\n                    {\r\n                        urls: process.env.REACT_APP_TURN_SERVERS.split(','),\r\n                        username: process.env.REACT_APP_TURN_USERNAME,\r\n                        credential: process.env.REACT_APP_TURN_CREDENCIAL\r\n                    },\r\n                ]\r\n            }\r\n        })\r\n        return this.peer\r\n    }\r\n    connect = (otherId) => {\r\n        this.peer.signal(otherId)\r\n    }  \r\n} ","export async function getDisplayStream(){\r\n    return navigator.mediaDevices.getDisplayMedia();\r\n}","import React from 'react'\r\nexport const ShareScreenIcon = () => (\r\n    <svg xmlns=\"http://www.w3.org/2000/svg\" width=\"32\" height=\"32\" viewBox=\"0 0 24 24\"><path fill=\"none\" d=\"M0 0h24v24H0V0z\"/><path fill=\"greenyellow\" d=\"M20 18c1.1 0 1.99-.9 1.99-2L22 6c0-1.11-.9-2-2-2H4c-1.11 0-2 .89-2 2v10c0 1.1.89 2 2 2H0v2h24v-2h-4zm-7-3.53v-2.19c-2.78 0-4.61.85-6 2.72.56-2.67 2.11-5.33 6-5.87V7l4 3.73-4 3.74z\"/></svg>\r\n);\r\n\r\nexport const MicOnIcon = () => (\r\n    <svg xmlns=\"http://www.w3.org/2000/svg\" width=\"32\" height=\"32\" viewBox=\"0 0 24 24\"><path fill=\"greenyellow\" d=\"M12 14c1.66 0 2.99-1.34 2.99-3L15 5c0-1.66-1.34-3-3-3S9 3.34 9 5v6c0 1.66 1.34 3 3 3zm5.3-3c0 3-2.54 5.1-5.3 5.1S6.7 14 6.7 11H5c0 3.41 2.72 6.23 6 6.72V21h2v-3.28c3.28-.48 6-3.3 6-6.72h-1.7z\"/><path d=\"M0 0h24v24H0z\" fill=\"none\"/></svg>\r\n)\r\n\r\nexport const MicOffIcon = () => (\r\n    <svg xmlns=\"http://www.w3.org/2000/svg\" width=\"32\" height=\"32\" viewBox=\"0 0 24 24\"><path d=\"M0 0h24v24H0zm0 0h24v24H0z\" fill=\"none\"/><path fill=\"greenyellow\" d=\"M19 11h-1.7c0 .74-.16 1.43-.43 2.05l1.23 1.23c.56-.98.9-2.09.9-3.28zm-4.02.17c0-.06.02-.11.02-.17V5c0-1.66-1.34-3-3-3S9 3.34 9 5v.18l5.98 5.99zM4.27 3L3 4.27l6.01 6.01V11c0 1.66 1.33 3 2.99 3 .22 0 .44-.03.65-.08l1.66 1.66c-.71.33-1.5.52-2.31.52-2.76 0-5.3-2.1-5.3-5.1H5c0 3.41 2.72 6.23 6 6.72V21h2v-3.28c.91-.13 1.77-.45 2.54-.9L19.73 21 21 19.73 4.27 3z\"/></svg>\r\n)\r\n\r\nexport const CamOnIcon = () => (\r\n    <svg xmlns=\"http://www.w3.org/2000/svg\" width=\"32\" height=\"32\" viewBox=\"0 0 24 24\"><path d=\"M0 0h24v24H0z\" fill=\"none\"/><path fill=\"greenyellow\" d=\"M17 10.5V7c0-.55-.45-1-1-1H4c-.55 0-1 .45-1 1v10c0 .55.45 1 1 1h12c.55 0 1-.45 1-1v-3.5l4 4v-11l-4 4z\"/></svg>\r\n)\r\n\r\nexport const CamOffIcon = () => (\r\n    <svg xmlns=\"http://www.w3.org/2000/svg\" width=\"32\" height=\"32\" viewBox=\"0 0 24 24\"><path d=\"M0 0h24v24H0zm0 0h24v24H0z\" fill=\"none\"/><path fill=\"greenyellow\" d=\"M21 6.5l-4 4V7c0-.55-.45-1-1-1H9.82L21 17.18V6.5zM3.27 2L2 3.27 4.73 6H4c-.55 0-1 .45-1 1v10c0 .55.45 1 1 1h12c.21 0 .39-.08.54-.18L19.73 21 21 19.73 3.27 2z\"/></svg>\r\n)\r\n","import React from 'react';\r\nimport VideoCall from '../helpers/simple-peer';\r\nimport '../styles/video.css';\r\nimport io from 'socket.io-client';\r\nimport { getDisplayStream } from '../helpers/media-access';\r\nimport {ShareScreenIcon,MicOnIcon,MicOffIcon,CamOnIcon,CamOffIcon} from './Icons';\r\n\r\nclass Video extends React.Component {\r\n  constructor() {\r\n    super();\r\n    this.state = {\r\n      localStream: {},\r\n      remoteStreamUrl: '',\r\n      streamUrl: '',\r\n      initiator: false,\r\n      peer: {},\r\n      full: false,\r\n      connecting: false,\r\n      waiting: true,\r\n      micState:true,\r\n      camState:true,\r\n    };\r\n  }\r\n  videoCall = new VideoCall();\r\n\r\n  componentDidMount() {\r\n    const socket = io(process.env.REACT_APP_SIGNALING_SERVER);\r\n    const component = this;\r\n    this.setState({ socket });\r\n    const { roomId } = this.props.match.params;\r\n    this.getUserMedia().then(() => {\r\n      socket.emit('join', { roomId: roomId });\r\n    });\r\n\r\n    socket.on('init', () => {\r\n      component.setState({ initiator: true });\r\n    });\r\n    socket.on('ready', () => {\r\n      component.enter(roomId);\r\n    });\r\n    socket.on('desc', data => {\r\n      if (data.type === 'offer' && component.state.initiator) return;\r\n      if (data.type === 'answer' && !component.state.initiator) return;\r\n      component.call(data);\r\n    });\r\n    socket.on('disconnected', () => {\r\n      component.setState({ initiator: true });\r\n    });\r\n    socket.on('full', () => {\r\n      component.setState({ full: true });\r\n    });\r\n  }\r\n\r\n\r\n  getUserMedia(cb) {\r\n    return new Promise((resolve, reject) => {\r\n      navigator.getUserMedia = navigator.getUserMedia =\r\n        navigator.getUserMedia ||\r\n        navigator.webkitGetUserMedia ||\r\n        navigator.mozGetUserMedia;\r\n      const op = {\r\n        video: {\r\n          width: { min: 160, ideal: 640, max: 1280 },\r\n          height: { min: 120, ideal: 360, max: 720 }\r\n        },\r\n        audio: true\r\n      };\r\n      navigator.getUserMedia(\r\n        op,\r\n        stream => {\r\n          this.setState({ streamUrl: stream, localStream: stream });\r\n          this.localVideo.srcObject = stream;\r\n          resolve();\r\n        },\r\n        () => {}\r\n      );\r\n    });\r\n  }\r\n\r\n  setAudioLocal(){\r\n    if(this.state.localStream.getAudioTracks().length>0){\r\n      this.state.localStream.getAudioTracks().forEach(track => {\r\n        track.enabled=!track.enabled;\r\n      });\r\n    }\r\n    this.setState({\r\n      micState:!this.state.micState\r\n    })\r\n  }\r\n\r\n  setVideoLocal(){\r\n    if(this.state.localStream.getVideoTracks().length>0){\r\n      this.state.localStream.getVideoTracks().forEach(track => {\r\n        track.enabled=!track.enabled;\r\n      });\r\n    }\r\n    this.setState({\r\n      camState:!this.state.camState\r\n    })\r\n  }\r\n\r\n  getDisplay() {\r\n    getDisplayStream().then(stream => {\r\n      stream.oninactive = () => {\r\n        this.state.peer.removeStream(this.state.localStream);\r\n        this.getUserMedia().then(() => {\r\n          this.state.peer.addStream(this.state.localStream);\r\n        });\r\n      };\r\n      this.setState({ streamUrl: stream, localStream: stream });\r\n      this.localVideo.srcObject = stream;\r\n      this.state.peer.addStream(stream);\r\n    });\r\n  }\r\n\r\n  enter = roomId => {\r\n    this.setState({ connecting: true });\r\n    const peer = this.videoCall.init(\r\n      this.state.localStream,\r\n      this.state.initiator\r\n    );\r\n    this.setState({ peer });\r\n\r\n    peer.on('signal', data => {\r\n      const signal = {\r\n        room: roomId,\r\n        desc: data\r\n      };\r\n      this.state.socket.emit('signal', signal);\r\n    });\r\n    peer.on('stream', stream => {\r\n      this.remoteVideo.srcObject = stream;\r\n      this.setState({ connecting: false, waiting: false });\r\n    });\r\n    peer.on('error', function(err) {\r\n      console.log(err);\r\n    });\r\n  };\r\n\r\n  call = otherId => {\r\n    this.videoCall.connect(otherId);\r\n  };\r\n  renderFull = () => {\r\n    if (this.state.full) {\r\n      return 'The room is full';\r\n    }\r\n  };\r\n  render() {\r\n    return (\r\n      <div className='video-wrapper'>\r\n        <div className='local-video-wrapper'>\r\n          <video\r\n            autoPlay\r\n            id='localVideo'\r\n            muted\r\n            ref={video => (this.localVideo = video)}\r\n          />\r\n        </div>\r\n        <video\r\n          autoPlay\r\n          className={`${\r\n            this.state.connecting || this.state.waiting ? 'hide' : ''\r\n          }`}\r\n          id='remoteVideo'\r\n          ref={video => (this.remoteVideo = video)}\r\n        />\r\n\r\n        <div className='controls'>\r\n        <button\r\n          className='control-btn'\r\n          onClick={() => {\r\n            this.getDisplay();\r\n          }}\r\n        >\r\n          <ShareScreenIcon />\r\n        </button>\r\n\r\n\r\n        <button\r\n        className='control-btn'\r\n          onClick={() => {\r\n            this.setAudioLocal();\r\n          }}\r\n        >\r\n          {\r\n            this.state.micState?(\r\n              <MicOnIcon/>\r\n            ):(\r\n              <MicOffIcon/>\r\n            )\r\n          }\r\n        </button>\r\n\r\n        <button\r\n        className='control-btn'\r\n          onClick={() => {\r\n            this.setVideoLocal();\r\n          }}\r\n        >\r\n          {\r\n            this.state.camState?(\r\n              <CamOnIcon/>\r\n            ):(\r\n              <CamOffIcon/>\r\n            )\r\n          }\r\n        </button>\r\n        </div>\r\n        \r\n\r\n\r\n        {this.state.connecting && (\r\n          <div className='status'>\r\n            <p>Establishing connection...</p>\r\n          </div>\r\n        )}\r\n        {this.state.waiting && (\r\n          <div className='status'>\r\n            <p>Waiting for someone...</p>\r\n          </div>\r\n        )}\r\n        {this.renderFull()}\r\n      </div>\r\n    );\r\n  }\r\n}\r\n\r\nexport default Video;\r\n","import React, { useState } from 'react'\r\nimport shortId from 'shortid'\r\n\r\nconst goToRoom = (history, roomId) => {\r\n  history.push(`/${roomId}`)\r\n}\r\n\r\n\r\nexport function goToRoomInput({history}) {\r\n  let [roomId, setRoomId] = useState(shortId.generate());\r\n\r\n  return (<div className=\"enter-room-container\">\r\n    <form>\r\n          <input type=\"text\" value={roomId} placeholder=\"Room id\" onChange={(event) => {\r\n            setRoomId(event.target.value)\r\n          }}/>\r\n          <button onClick={() => {\r\n            goToRoom(history, roomId)\r\n          }}>Enter</button>\r\n          </form>\r\n        </div>)\r\n}","import React, { Component } from 'react';\r\nimport Video from './components/video'\r\nimport './App.css';\r\nimport './styles/video.css'\r\nimport { BrowserRouter, Route } from 'react-router-dom';\r\nimport { goToRoomInput } from './components/goToRoomInput';\r\nclass App extends Component {\r\n  render() {\r\n    return (\r\n      <BrowserRouter>\r\n       <React.Fragment>\r\n          <Route path=\"/\" exact component={goToRoomInput}/>\r\n          <Route path=\"/:roomId\" exact component={Video}/>\r\n        </React.Fragment>\r\n      </BrowserRouter>\r\n    )\r\n  }\r\n}\r\n\r\nexport default App;\r\n","// In production, we register a service worker to serve assets from local cache.\r\n\r\n// This lets the app load faster on subsequent visits in production, and gives\r\n// it offline capabilities. However, it also means that developers (and users)\r\n// will only see deployed updates on the \"N+1\" visit to a page, since previously\r\n// cached resources are updated in the background.\r\n\r\n// To learn more about the benefits of this model, read https://goo.gl/KwvDNy.\r\n// This link also includes instructions on opting out of this behavior.\r\n\r\nconst isLocalhost = Boolean(\r\n  window.location.hostname === 'localhost' ||\r\n    // [::1] is the IPv6 localhost address.\r\n    window.location.hostname === '[::1]' ||\r\n    // 127.0.0.1/8 is considered localhost for IPv4.\r\n    window.location.hostname.match(\r\n      /^127(?:\\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/\r\n    )\r\n);\r\n\r\nexport default function register() {\r\n  if (process.env.NODE_ENV === 'production' && 'serviceWorker' in navigator) {\r\n    // The URL constructor is available in all browsers that support SW.\r\n    const publicUrl = new URL(process.env.PUBLIC_URL, window.location);\r\n    if (publicUrl.origin !== window.location.origin) {\r\n      // Our service worker won't work if PUBLIC_URL is on a different origin\r\n      // from what our page is served on. This might happen if a CDN is used to\r\n      // serve assets; see https://github.com/facebookincubator/create-react-app/issues/2374\r\n      return;\r\n    }\r\n\r\n    window.addEventListener('load', () => {\r\n      const swUrl = `${process.env.PUBLIC_URL}/service-worker.js`;\r\n\r\n      if (isLocalhost) {\r\n        // This is running on localhost. Lets check if a service worker still exists or not.\r\n        checkValidServiceWorker(swUrl);\r\n\r\n        // Add some additional logging to localhost, pointing developers to the\r\n        // service worker/PWA documentation.\r\n        navigator.serviceWorker.ready.then(() => {\r\n          console.log(\r\n            'This web app is being served cache-first by a service ' +\r\n              'worker. To learn more, visit https://goo.gl/SC7cgQ'\r\n          );\r\n        });\r\n      } else {\r\n        // Is not local host. Just register service worker\r\n        registerValidSW(swUrl);\r\n      }\r\n    });\r\n  }\r\n}\r\n\r\nfunction registerValidSW(swUrl) {\r\n  navigator.serviceWorker\r\n    .register(swUrl)\r\n    .then(registration => {\r\n      registration.onupdatefound = () => {\r\n        const installingWorker = registration.installing;\r\n        installingWorker.onstatechange = () => {\r\n          if (installingWorker.state === 'installed') {\r\n            if (navigator.serviceWorker.controller) {\r\n              // At this point, the old content will have been purged and\r\n              // the fresh content will have been added to the cache.\r\n              // It's the perfect time to display a \"New content is\r\n              // available; please refresh.\" message in your web app.\r\n              console.log('New content is available; please refresh.');\r\n            } else {\r\n              // At this point, everything has been precached.\r\n              // It's the perfect time to display a\r\n              // \"Content is cached for offline use.\" message.\r\n              console.log('Content is cached for offline use.');\r\n            }\r\n          }\r\n        };\r\n      };\r\n    })\r\n    .catch(error => {\r\n      console.error('Error during service worker registration:', error);\r\n    });\r\n}\r\n\r\nfunction checkValidServiceWorker(swUrl) {\r\n  // Check if the service worker can be found. If it can't reload the page.\r\n  fetch(swUrl)\r\n    .then(response => {\r\n      // Ensure service worker exists, and that we really are getting a JS file.\r\n      if (\r\n        response.status === 404 ||\r\n        response.headers.get('content-type').indexOf('javascript') === -1\r\n      ) {\r\n        // No service worker found. Probably a different app. Reload the page.\r\n        navigator.serviceWorker.ready.then(registration => {\r\n          registration.unregister().then(() => {\r\n            window.location.reload();\r\n          });\r\n        });\r\n      } else {\r\n        // Service worker found. Proceed as normal.\r\n        registerValidSW(swUrl);\r\n      }\r\n    })\r\n    .catch(() => {\r\n      console.log(\r\n        'No internet connection found. App is running in offline mode.'\r\n      );\r\n    });\r\n}\r\n\r\nexport function unregister() {\r\n  if ('serviceWorker' in navigator) {\r\n    navigator.serviceWorker.ready.then(registration => {\r\n      registration.unregister();\r\n    });\r\n  }\r\n}\r\n","import React from 'react';\r\nimport ReactDOM from 'react-dom';\r\nimport './index.css';\r\nimport App from './App';\r\nimport registerServiceWorker from './registerServiceWorker';\r\n\r\nReactDOM.render(<App />, document.getElementById('root'));\r\nregisterServiceWorker();\r\n"],"sourceRoot":""}